(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{413:function(e,t,n){e.exports=n(983)},48:function(e,t,n){},943:function(e,t,n){},979:function(e,t){},983:function(e,t,n){"use strict";n.r(t);n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(170),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(461),n(462),n(464),n(465),n(466),n(467),n(241),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(506),n(507),n(508),n(509),n(510),n(511),n(512),n(513),n(514),n(515),n(516),n(517),n(518),n(519),n(520),n(522),n(523),n(524),n(525),n(526),n(527),n(528),n(530),n(531),n(532),n(533),n(534),n(535),n(536),n(537),n(538),n(539),n(540),n(541),n(542),n(543),n(544),n(316),n(545),n(546),n(547),n(548),n(317),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(563),n(564),n(565),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(588),n(589),n(590),n(591),n(592),n(593),n(594),n(595),n(596),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(607),n(251),n(608),n(609),n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(617),n(618),n(619),n(620),n(621),n(622),n(624),n(625),n(626),n(627),n(628),n(629),n(630),n(631),n(632),n(633),n(634),n(635),n(636),n(637),n(638),n(639),n(640),n(641),n(642),n(643),n(644),n(645),n(646),n(647),n(648),n(649),n(650),n(651),n(652),n(653),n(654),n(655),n(656),n(657),n(658),n(659),n(660),n(661),n(662),n(663),n(664),n(665),n(666),n(667),n(668),n(669),n(670),n(671),n(672),n(673),n(674),n(675),n(676),n(677),n(678),n(679),n(680),n(681),n(682),n(683),n(684),n(685),n(686),n(687),n(688),n(689),n(690),n(691),n(692),n(693),n(694),n(695),n(697),n(327),n(698),n(701),n(751);var r=n(0),o=n.n(r),a=n(208),s=n.n(a),i=(n(943),n(137)),c=n(93),l=n(31),h=n(6),u=n(9),p=n(8),m=n(5),d=n(10),f=n(2);function g(e){return 255*Math.sqrt(e/255)}var b=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,e),this.fillColor=function(){if(r.threeDimMeshes.length>0){var e=r.threeDimMeshes[0].material.map;r.threeDimMeshes[0].material.dispose();var t=new f.h({map:e,color:new f.c(r.red/255,r.green/255,r.blue/255)});r.threeDimMeshes.forEach(function(e){e.material=t})}},this.dispose=function(){for(;r.threeDimMeshes.length>0;){var e=r.threeDimMeshes.pop();e.geometry.dispose(),e.material.dispose()}},this.removeFrom=function(e){r.threeDimMeshes.forEach(function(t){e.remove(t)})},this.id=t.id,this.type=t.type,this.posx=t.posx,this.posz=t.posz,this.theta=t.theta,this.params=t.params,this.roomId=t.roomId,this.colorName=t.colorName,n&&n[this.colorName]&&(o?(this.red=g(n[this.colorName].red),this.green=g(n[this.colorName].green),this.blue=g(n[this.colorName].blue)):(this.red=n[this.colorName].red,this.green=n[this.colorName].green,this.blue=n[this.colorName].blue)),this.threeDimMeshes=[]}return Object(m.a)(e,[{key:"objVal",value:function(){return{id:this.id,type:this.type,posx:this.posx,posz:this.posz,theta:this.theta,params:this.params,roomId:this.roomId,colorName:this.colorName}}},{key:"updateFromObject",value:function(e,t){this.id=e.id,this.type=e.type,this.posx=e.posx,this.posz=e.posz,this.theta=e.theta,this.params=e.params,this.roomId=e.roomId,this.colorName=e.colorName,t&&t[this.colorName]&&(this.red=t[this.colorName].red,this.green=t[this.colorName].green,this.blue=t[this.colorName].blue)}},{key:"checkIntersect",value:function(e){var t=e.intersectObjects(this.threeDimMeshes,!0);if(t.length>0){var n=t[0].distance;return t.forEach(function(e){e.distance<n&&(n=e.distance)}),n}return-1}},{key:"moveX",value:function(e){var t=new f.f;t.makeTranslation(e,0,0),this.threeDimMeshes.forEach(function(e){e.applyMatrix(t)}),this.posx+=e}},{key:"moveZ",value:function(e){var t=new f.f;t.makeTranslation(0,0,e),this.threeDimMeshes.forEach(function(e){e.applyMatrix(t)}),this.posz+=e}},{key:"moveTheta",value:function(e){var t=new f.f,n=new f.f,r=new f.f;n.makeTranslation(this.posx,0,this.posz),t.makeTranslation(-this.posx,0,-this.posz),r.makeRotationY(e),this.threeDimMeshes.forEach(function(e){e.applyMatrix(t),e.applyMatrix(r),e.applyMatrix(n)}),this.theta+=e}},{key:"renderFurnishing",value:function(e,t,n){var r=new f.f;r.makeRotationY(this.theta);var o=new f.f;return o.makeTranslation(this.posx,0,this.posz),this.threeDimMeshes.forEach(function(e){e.castShadow=!0,e.receiveShadow=!0,e.applyMatrix(r),e.applyMatrix(o),n.add(e)}),e.render(n,t),n}}],[{key:"doInit",value:function(e,t,n){e.renderLists.dispose();var r=new f.o;return r.add(t),e.render(r,n),r}}]),e}(),v=(new f.p).load("lines.png");v.wrapS=f.i,v.wrapT=f.i,v.repeat.set(2,2);var w=v,E=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(1.35,.135,1.35),a);s.position.set(0,1.215,0);var i=new f.g(new f.d(.135,.135,1.08,25),a);i.position.set(-.675,.675,.675),i.rotation.x=-.25,i.rotation.z=-.25;var c=new f.g(new f.d(.135,.135,1.08,25),a);c.position.set(.675,.675,.675),c.rotation.x=-.25,c.rotation.z=.25;var l=new f.g(new f.d(.135,.135,1.08,25),a);l.position.set(-.675,.675,-.675),l.rotation.x=.25,l.rotation.z=-.25;var m=new f.g(new f.d(.135,.135,1.08,25),a);return m.position.set(.675,.675,-.675),m.rotation.x=.25,m.rotation.z=.25,r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),O=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(3*1.35,.135,1.35),a);s.position.set(0,1.215,0);var i=new f.g(new f.d(.135,.135,1.08,25),a);i.position.set(1.35*-1.5,.675,.675),i.rotation.x=-.25,i.rotation.z=-.25;var c=new f.g(new f.d(.135,.135,1.08,25),a);c.position.set(1.5*1.35,.675,.675),c.rotation.x=-.25,c.rotation.z=.25;var l=new f.g(new f.d(.135,.135,1.08,25),a);l.position.set(1.35*-1.5,.675,-.675),l.rotation.x=.25,l.rotation.z=-.25;var m=new f.g(new f.d(.135,.135,1.08,25),a);return m.position.set(1.5*1.35,.675,-.675),m.rotation.x=.25,m.rotation.z=.25,r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),y=(new f.p).load("dirt.png");y.wrapS=f.i,y.wrapT=f.i,y.repeat.set(2,2);var k=y,S=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:k,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(.8,.8*.1,.8),a);s.position.set(0,.72,0);var i=new f.g(new f.d(.8*.1,.8*.1,.8*.8,25),a);i.position.set(-.4,.4,.4),i.rotation.x=-.25,i.rotation.z=-.25;var c=new f.g(new f.d(.1*.8,.1*.8,.8*.8,25),a);c.position.set(.4,.4,.4),c.rotation.x=-.25,c.rotation.z=.25;var l=new f.g(new f.d(.1*.8,.1*.8,.8*.8,25),a);l.position.set(-.4,.4,-.4),l.rotation.x=.25,l.rotation.z=-.25;var m=new f.g(new f.d(.1*.8,.1*.8,.8*.8,25),a);return m.position.set(.4,.4,-.4),m.rotation.x=.25,m.rotation.z=.25,r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),j=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:k,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=1.5*.6,i=new f.g(new f.b(.09,1*s,1*s),a);i.position.set(.495,1.4*s,0),i.rotation.z=-.25;var c=new f.g(new f.b(1*s,.09,1*s),a);c.position.set(0,-.09+s,0);var l=new f.g(new f.d(.09,.09,.72,25),a);l.position.set(-.5*s,-.5*s+s,.5*s),l.rotation.x=-.25,l.rotation.z=-.25;var m=new f.g(new f.d(.09,.09,.72,25),a);m.position.set(.5*s,-.5*s+s,.5*s),m.rotation.x=-.25,m.rotation.z=.25;var d=new f.g(new f.d(.09,.09,.72,25),a);d.position.set(-.5*s,-.5*s+s,-.5*s),d.rotation.x=.25,d.rotation.z=-.25;var g=new f.g(new f.d(.09,.09,.72,25),a);return g.position.set(.5*s,-.5*s+s,-.5*s),g.rotation.x=.25,g.rotation.z=.25,r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r.threeDimMeshes.push(d),r.threeDimMeshes.push(g),r.threeDimMeshes.push(i),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),M=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:k,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(2.1*1.3,.78,2.6*1.3),a);s.position.set(0,.91,0);var i=new f.g(new f.d(.13,.13,1.04,25),a);i.position.set(1.3*-.9,.65,1.1*1.3);var c=new f.g(new f.d(.13,.13,1.04,25),a);c.position.set(.9*1.3,.65,1.1*1.3);var l=new f.g(new f.d(.13,.13,1.04,25),a);l.position.set(1.3*-.9,.65,1.3*-1.1);var m=new f.g(new f.d(.13,.13,1.04,25),a);return m.position.set(.9*1.3,.65,1.3*-1.1),r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),R=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(1.5,1.875,1.125),a);s.position.set(0,1.3125,0);var i=new f.g(new f.d(.125,.125,.25,25),a);i.position.set(-.625,.25,.375);var c=new f.g(new f.d(.125,.125,.25,25),a);c.position.set(.625,.25,.375);var l=new f.g(new f.d(.125,.125,.25,25),a);l.position.set(-.625,.25,-.375);var m=new f.g(new f.d(.125,.125,.25,25),a);return m.position.set(.625,.25,-.375),r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),D=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(2.275,.65,.9*1.3),a);s.position.set(0,1.17,0);var i=new f.g(new f.d(.13,.13,.65*1.3,25),a);i.position.set(1.3*-.75,.5525,.39);var c=new f.g(new f.d(.13,.13,.65*1.3,25),a);c.position.set(.75*1.3,.5525,.39);var l=new f.g(new f.d(.13,.13,.65*1.3,25),a);l.position.set(1.3*-.75,.5525,-.39);var m=new f.g(new f.d(.13,.13,.65*1.3,25),a);return m.position.set(.75*1.3,.5525,-.39),r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),T=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(.3*1.5,.4*1.5,.3*1.5),a);s.position.set(0,1.35,0);var i=new f.g(new f.d(.03,.03,.6*1.5,25),a);i.position.set(-.195,.4*1.5,.195);var c=new f.g(new f.d(.03,.03,.6*1.5,25),a);c.position.set(.195,.4*1.5,.195);var l=new f.g(new f.d(.03,.03,.6*1.5,25),a);l.position.set(-.195,.4*1.5,-.195);var m=new f.g(new f.d(.03,.03,.6*1.5,25),a);return m.position.set(.195,.4*1.5,-.195),r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),C=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:k,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(1.16,.5075,3.625),a);s.position.set(0,.58,0);var i=new f.g(new f.b(.29,1.16,3.625),a);i.position.set(.54375,1.305,0),i.rotation.z=-.2;var c=new f.g(new f.b(.87,.725,.145),a);c.position.set(0,.8699999999999999,1.74);var l=new f.g(new f.b(.87,.725,.145),a);l.position.set(0,.8699999999999999,-1.74);var m=new f.g(new f.d(.145,.145,.29,25),a);m.position.set(-.435,.29,1.45);var d=new f.g(new f.d(.145,.145,.29,25),a);d.position.set(.435,.29,1.45);var g=new f.g(new f.d(.145,.145,.29,25),a);g.position.set(-.435,.29,-1.45);var b=new f.g(new f.d(.145,.145,.29,25),a);return b.position.set(.435,.29,-1.45),r.threeDimMeshes.push(s),r.threeDimMeshes.push(m),r.threeDimMeshes.push(d),r.threeDimMeshes.push(g),r.threeDimMeshes.push(b),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),F=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),r=Object(u.a)(this,Object(p.a)(t).call(this,e,n,o));var a=new f.h({map:w,color:new f.c(r.red/255,r.green/255,r.blue/255)}),s=new f.g(new f.b(1.2,.1,.9),a);s.position.set(0,.2,0);var i=new f.g(new f.b(1.2,.1,.9),a);i.position.set(0,.54+.15,0);var c=new f.g(new f.b(1.2,.1,.9),a);c.position.set(0,1.18,0);var l=new f.g(new f.b(1.2,.1,.9),a);l.position.set(0,1.67,0);var m=new f.g(new f.b(1.2,.1,.9),a);m.position.set(0,2.01+.15,0);var d=new f.g(new f.b(1.2,.1,.9),a);d.position.set(0,2.65,0);var g=new f.g(new f.b(1.2,2.45+.1,.1),a);g.position.set(0,1.425,-.4);var b=new f.g(new f.b(.1,2.45+.1,.9),a);b.position.set(-.58,1.425,0);var v=new f.g(new f.b(.1,2.45+.1,.9),a);return v.position.set(.58,1.425,0),r.threeDimMeshes.push(s),r.threeDimMeshes.push(i),r.threeDimMeshes.push(c),r.threeDimMeshes.push(l),r.threeDimMeshes.push(m),r.threeDimMeshes.push(d),r.threeDimMeshes.push(g),r.threeDimMeshes.push(b),r.threeDimMeshes.push(v),r}return Object(d.a)(t,e),Object(m.a)(t,[{key:"clone",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(this.objVal(),e,n)}}]),t}(b),I=n(85),P=n.n(I);var _=n(38);var L=Object(i.b)({room:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_FURNISHING":switch(t.name){case"bed":var n=new M({id:P()(),type:"bed",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return n.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:n.objVal()}),[].concat(Object(l.a)(e),[n]);case"chair":var r=new j({id:P()(),type:"chair",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return r.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:r.objVal()}),[].concat(Object(l.a)(e),[r]);case"desk":var o=new D({id:P()(),type:"desk",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return o.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:o.objVal()}),[].concat(Object(l.a)(e),[o]);case"table":var a=new E({id:P()(),type:"table",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return a.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:a.objVal()}),[].concat(Object(l.a)(e),[a]);case"bookcase":var s=new F({id:P()(),type:"bookcase",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return s.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:s.objVal()}),[].concat(Object(l.a)(e),[s]);case"dresser":var i=new R({id:P()(),type:"dresser",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return i.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:i.objVal()}),[].concat(Object(l.a)(e),[i]);case"longtable":var c=new O({id:P()(),type:"longtable",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return c.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:c.objVal()}),[].concat(Object(l.a)(e),[c]);case"nightstand":var h=new T({id:P()(),type:"nightstand",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return h.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:h.objVal()}),[].concat(Object(l.a)(e),[h]);case"sofa":var u=new C({id:P()(),type:"sofa",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return u.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:u.objVal()}),[].concat(Object(l.a)(e),[u]);case"stool":var p=new S({id:P()(),type:"stool",posx:0,posz:0,theta:0,params:"",roomId:1,colorName:t.colorName},t.colors);return p.renderFurnishing(t.renderer,t.camera,t.scene),t.socket&&t.socket.emit("createFurnishing",{furnishing:p.objVal()}),[].concat(Object(l.a)(e),[p])}return e;case"ADD_FURNISHING_FROM_OBJECT":switch(t.obj.type){case"bed":var m=new M(t.obj,t.colors);return m.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[m]);case"chair":var d=new j(t.obj,t.colors);return d.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[d]);case"desk":var f=new D(t.obj,t.colors);return f.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[f]);case"table":var g=new E(t.obj,t.colors);return g.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[g]);case"bookcase":var b=new F(t.obj,t.colors);return b.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[b]);case"dresser":var v=new R(t.obj,t.colors);return v.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[v]);case"longtable":var w=new O(t.obj,t.colors);return w.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[w]);case"nightstand":var y=new T(t.obj,t.colors);return y.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[y]);case"sofa":var k=new C(t.obj,t.colors);return k.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[k]);case"stool":var I=new S(t.obj,t.colors);return I.renderFurnishing(t.renderer,t.camera,t.scene),[].concat(Object(l.a)(e),[I])}return e;case"DELETE_FURNISHING":var _=e.find(function(e){return e.id===t.furnishingId});return _&&_.dispose(),e.filter(function(e){return e.id!==t.furnishingId});case"ROOM_LOGOUT":for(var L=0;L<e.length;L++)e[L].dispose();return[];case"REMOVE_ALL_FURNISHINGS":for(var N=0;N<e.length;N++)e[N].dispose();return[];default:return e}},file:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{amOwner:!1,roomProperties:null,availableRooms:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_OWNER":return Object(_.a)({},e,{amOwner:t.val});case"SET_ROOM_PROPERTIES":return Object(_.a)({},e,{roomProperties:Object(_.a)({},t.roomProperties)});case"SET_AVAILABLE_ROOMS":return Object(_.a)({},e,{availableRooms:Object(_.a)({},t.rooms)});case"RESET_FILE":return Object(_.a)({},e,{amOwner:!1,roomProperties:null});case"FILE_LOGOUT":return{amOwner:!1,roomProperties:null,availableRooms:null};default:return e}},lock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lockRequested:!1,mouseDown:!1,lockObtained:!1,furnishingId:null,mousex:null,mousey:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FURNISHING":return Object(_.a)({},e,{furnishingId:t.furnishingId});case"UN_LOCK":return{lockRequested:!1,dragging:!1,lockObtained:!1,furnishingId:null,mousex:null,mousey:null};case"SET_LOCK_REQUESTED":return Object(_.a)({},e,{lockRequested:!0});case"SET_LOCK_APPROVED":return Object(_.a)({},e,{lockObtained:!0});case"SET_MOUSE_DOWN":return Object(_.a)({},e,{mouseDown:!0,mousex:t.mousex,mousey:t.mousey});case"UN_SET_MOUSE_DOWN":return Object(_.a)({},e,{mouseDown:!1});case"LOCK_LOGOUT":return{lockRequested:!1,mouseDown:!1,lockObtained:!1,furnishingId:null,mousex:null,mousey:null};default:return e}},mode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mode:"move",colorName:"green"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODE":return Object(_.a)({},e,{mode:t.mode});case"SET_COLOR":return Object(_.a)({},e,{colorName:t.colorName});case"MODE_LOGOUT":return{mode:"move",colorName:"green"};default:return e}},undo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PUSH_TO_UNDO_STACK":return[].concat(Object(l.a)(e),[t.stateToPush]);case"POP_UNDO_STACK":var n=Object(l.a)(e);return n.pop(),n;case"CLEAR_UNDO_STACK":return[];default:return e}},redo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PUSH_TO_REDO_STACK":return[].concat(Object(l.a)(e),[t.stateToPush]);case"POP_REDO_STACK":var n=Object(l.a)(e);return n.pop(),n;case"CLEAR_REDO_STACK":return[];default:return e}}}),N=(n(48),n(410)),x=n(109),U=n(406),A=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=!0;return this.props.style&&"yellow"===this.props.style.backgroundColor&&(t=!1),o.a.createElement("form",{style:{display:"inline"},onSubmit:function(t){t.preventDefault(),e.props.handleSubmit(t),t.target.reset()}},o.a.createElement("button",{title:this.props.value,style:Object(_.a)({},this.props.style,{backgroundColor:t?"#ff9d00":this.props.style.backgroundColor}),type:"submit"},this.props.icon?o.a.createElement(U.a,null,this.props.icon):this.props.value))}}]),t}(o.a.Component),z=window.location.href.includes("localhost")?"http://localhost:8000":"https://spaceplanner3d.herokuapp.com",V=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={err:""},n.handleSubmit=function(e){e.preventDefault();var t=n.props.alphanumericFilter(document.querySelector("#username").value),r=n.props.alphanumericFilter(document.querySelector("#password").value),o=n.props.alphanumericFilter(document.querySelector("#confirmPassword").value);t&&r&&o?fetch("".concat(z,"/api/").concat(t,"/exists"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){"user exists"===e.status?n.setState({err:"Username already taken"}):r!==o?n.setState({err:"Passwords must match"}):fetch("".concat(z,"/api/users"),{method:"POST",headers:{"Content-type":"application/json"},credentials:"include",body:JSON.stringify({username:t,password:r})}).then(function(e){return e.json()}).then(function(e){e.success?fetch("".concat(z,"/api/login"),{method:"POST",headers:{"Content-type":"application/json"},credentials:"include",body:JSON.stringify({username:t,password:r})}).then(function(){return n.props.history.push("/main")}):n.setState({err:"Could not create user"})})}):n.setState({err:"Username and password must be alphanumeric."})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(z,"/api/loggedin"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){t.status.includes("Logged in as ")&&e.props.history.push("/main")})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{width:"100%",paddingLeft:"50px",paddingTop:"20px"}},o.a.createElement(A,{value:"Return to Login",handleSubmit:function(){return e.props.history.push("/")}}),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("p",null,"Username: ",o.a.createElement("input",{type:"text",id:"username"})),o.a.createElement("p",null,"Password: ",o.a.createElement("input",{type:"password",id:"password"})),o.a.createElement("p",null,"Confirm Password: ",o.a.createElement("input",{type:"password",id:"confirmPassword"})),o.a.createElement("p",{style:{color:"red"}},o.a.createElement("b",null,this.state.err)),o.a.createElement("p",null,o.a.createElement("button",{type:"submit"},"Submit"))))}}]),t}(o.a.Component),G=n(408),K=n.n(G),X=n(409),H=n.n(X),q=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(u.a)(this,Object(p.a)(t).call(this))).style={boxShadow:"5px 5px 5px gray",position:"absolute",margin:"auto",left:"200px",top:"200px",width:"400px",backgroundColor:"white",borderStyle:"solid",zIndex:1,padding:"12px"},e}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null)}}]),t}(o.a.Component),Y=n(212),Z=n.n(Y),B=n(210),J=n.n(B),W=n(216),$=n.n(W),Q=n(213),ee=n.n(Q),te=n(214),ne=n.n(te),re=n(215),oe=n.n(re),ae=n(211),se=n.n(ae),ie=n(219),ce=n.n(ie),le=n(220),he=n.n(le),ue=n(221),pe=n.n(ue),me=n(222),de=n.n(me),fe=n(223),ge=n.n(fe),be=n(226),ve=n.n(be),we=n(227),Ee=n.n(we),Oe=n(224),ye=n.n(Oe),ke=n(225),Se=n.n(ke),je=n(217),Me=n.n(je),Re=n(218),De=n.n(Re),Te=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(u.a)(this,Object(p.a)(t).call(this))).iconStyle={verticalAlign:"middle",margin:"10px"},e}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:Object(_.a)({},this.style,{left:"100px",top:"50px",width:"600px"})},o.a.createElement("div",{id:"helpDiv",style:{height:"450px",overflow:"scroll"}},"The purpose of this app is to assist in the process of prototyping the design and layout of a room's interior space. The app is purely web-based; changes are saved automatically at all times, and several users can collaborate on the same room simultaneously.",o.a.createElement("h4",null,"Action Guide"),o.a.createElement("ul",{style:{listStyle:"none"}},o.a.createElement("li",null,o.a.createElement(J.a,{style:this.iconStyle}),"Logout"),o.a.createElement("li",null,o.a.createElement(se.a,{style:this.iconStyle}),"Open this help box"),o.a.createElement("li",null,o.a.createElement(Z.a,{style:this.iconStyle}),"Manage Account"),o.a.createElement("li",null,o.a.createElement(ee.a,{style:this.iconStyle}),"Create New Room"),o.a.createElement("li",null,o.a.createElement(ne.a,{style:this.iconStyle}),"Open a Room"),o.a.createElement("li",null,o.a.createElement(oe.a,{style:this.iconStyle}),o.a.createElement("em",null,"(if owner)")," Invite a user to collaborate on this room"),o.a.createElement("li",null,o.a.createElement($.a,{style:this.iconStyle}),o.a.createElement("em",null,"(if owner)")," Delete this room ",o.a.createElement("em",null,"permanently")),o.a.createElement("li",null,o.a.createElement(Me.a,{style:this.iconStyle}),"Undo the previous action"),o.a.createElement("li",null,o.a.createElement(De.a,{style:this.iconStyle}),"Redo"),o.a.createElement("li",null,o.a.createElement(ce.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Move an item via drag and drop"),o.a.createElement("li",null,o.a.createElement(he.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Rotate an item via drag and drop"),o.a.createElement("li",null,o.a.createElement(pe.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Add an item to the room"),o.a.createElement("li",null,o.a.createElement(de.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Delete an item by clicking on it"),o.a.createElement("li",null,o.a.createElement(ge.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Change the color of an item"),o.a.createElement("li",null,o.a.createElement(ye.a,{style:this.iconStyle}),"Reset the camera view"),o.a.createElement("li",null,o.a.createElement(Se.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Move the camera view"),o.a.createElement("li",null,o.a.createElement(ve.a,{style:this.iconStyle}),o.a.createElement("em",null,"(when selected)")," Rotate the camera view"),o.a.createElement("li",null,o.a.createElement(Ee.a,{style:this.iconStyle}),"Overhead view"))),o.a.createElement(A,{icon:o.a.createElement(K.a,null),value:"Up",handleSubmit:function(){return document.querySelector("#helpDiv").scrollTop-=100}}),o.a.createElement(A,{icon:o.a.createElement(H.a,null),value:"Down",handleSubmit:function(){return document.querySelector("#helpDiv").scrollTop+=100}}),o.a.createElement(A,{value:"OK",handleSubmit:this.props.okCallback}))}}]),t}(q),Ce=n(21),Fe=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(u.a)(this,Object(p.a)(t).call(this))).furnishingObj={bed:"Bed",bookcase:"Book Case",chair:"Chair",desk:"Desk",dresser:"Dresser",longtable:"Long Table",nightstand:"Night Stand",sofa:"Sofa",stool:"Stool",table:"Table"},e}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,"Choose furnishing to add:"),o.a.createElement("p",null,o.a.createElement("select",{id:"furnishingSelect",onChange:function(e){return e.preventDefault()}},o.a.createElement("option",{value:"-1"},"Select a furnishing..."),Object.keys(this.furnishingObj).map(function(t){return o.a.createElement("option",{value:t},e.furnishingObj[t])}))),o.a.createElement(A,{value:"Cancel",handleSubmit:this.props.cancelCallback}),o.a.createElement(A,{value:"OK",handleSubmit:function(){return e.props.okCallback(document.querySelector("#furnishingSelect").value)}}))}}]),t}(q),Ie=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={modal:null},n.onMoveClick=function(){n.props.setMode("move")},n.onRotateClick=function(){n.props.setMode("rotate")},n.onDeleteClick=function(){n.props.setMode("delete")},n.onColorClick=function(){n.props.setMode("color")},n.handleColorChange=function(e){e.preventDefault(),n.props.setColor(e.target.value)},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,"add"===this.state.modal?o.a.createElement(Fe,{cancelCallback:function(){return e.setState({modal:null})},okCallback:function(t){e.props.pushRoomToUndoStack(),e.props.clearRedoStack(),e.props.addFurnishing(t,e.props.socket,e.props.colors,e.props.mode.colorName,e.props.renderer(),e.props.camera(),e.props.scene()),e.setState({modal:null})}}):null,o.a.createElement("span",null,o.a.createElement(A,{style:{backgroundColor:"move"===this.props.mode.mode?"yellow":""},value:"Move",icon:o.a.createElement(ce.a,null),handleSubmit:function(){return e.onMoveClick()}}),o.a.createElement(A,{icon:o.a.createElement(he.a,null),style:{backgroundColor:"rotate"===this.props.mode.mode?"yellow":""},value:"Rotate",handleSubmit:function(){return e.onRotateClick()}}),o.a.createElement(A,{icon:o.a.createElement(pe.a,null),value:"Add furnishing",handleSubmit:function(){return e.setState({modal:"add"})}}),o.a.createElement(A,{icon:o.a.createElement(de.a,null),style:{backgroundColor:"delete"===this.props.mode.mode?"yellow":""},value:"Delete",handleSubmit:function(){return e.onDeleteClick()}}),o.a.createElement(A,{style:{backgroundColor:"color"===this.props.mode.mode?"yellow":""},value:"Color",icon:o.a.createElement(ge.a,null),handleSubmit:function(){return e.onColorClick()}}),o.a.createElement("select",{value:this.props.mode.colorName,onChange:this.handleColorChange},Object.keys(this.props.colors).map(function(t){return o.a.createElement("option",null,e.props.alphanumericFilter(t))}))))}}]),t}(o.a.Component),Pe=Object(c.b)(function(e){return{mode:e.mode}},function(e){return{setMode:function(t){return e({type:"SET_MODE",mode:t})},setColor:function(t){return e({type:"SET_COLOR",colorName:t})},addFurnishing:function(t,n,r,o,a,s,i){return e({type:"ADD_FURNISHING",name:t,socket:n,colors:r,colorName:o,renderer:a,camera:s,scene:i})},clearRedoStack:function(){return e({type:"CLEAR_REDO_STACK"})}}})(Ie),_e=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,"Enter room name ",o.a.createElement("span",{style:{color:"red"}},o.a.createElement("b",null,"(alphanumeric only, no spaces)")),", and size from 1 to 10:"),o.a.createElement("p",null,o.a.createElement("input",{type:"text",id:"roomName",placeholder:"Room name"}),o.a.createElement("input",{type:"text",id:"roomSize",placeholder:"Room size"})),o.a.createElement(A,{value:"Cancel",handleSubmit:this.props.cancelCallback}),o.a.createElement(A,{value:"OK",handleSubmit:function(){return e.props.okCallback(document.querySelector("#roomName").value,document.querySelector("#roomSize").value)}}))}}]),t}(q),Le=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,this.props.message),o.a.createElement(A,{value:"OK",handleSubmit:this.props.callback}))}}]),t}(q),Ne=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,"Choose room to open:"),o.a.createElement("p",null,o.a.createElement("select",{id:"openSelect",onChange:function(e){return e.preventDefault()}},o.a.createElement("option",{value:"-1"},"Select a room..."),Object.keys(this.props.availableRooms).map(function(t){var n=e.props.availableRooms[t];return o.a.createElement("option",{value:e.props.alphanumericFilter(n.id)},e.props.alphanumericFilter(n.name))}))),o.a.createElement(A,{value:"Cancel",handleSubmit:this.props.cancelCallback}),o.a.createElement(A,{value:"OK",handleSubmit:function(){return e.props.okCallback(document.querySelector("#openSelect").value)}}))}}]),t}(q),xe=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,"Enter username of user to invite:"),o.a.createElement("p",null,o.a.createElement("input",{type:"text",id:"invitee",placeholder:"User's username"})),o.a.createElement(A,{value:"Cancel",handleSubmit:this.props.cancelCallback}),o.a.createElement(A,{value:"OK",handleSubmit:function(){return e.props.okCallback(document.querySelector("#invitee").value)}}))}}]),t}(q),Ue=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:this.style},o.a.createElement("p",null,this.props.message),o.a.createElement(A,{value:"Cancel",handleSubmit:this.props.cancelCallback}),o.a.createElement(A,{value:"OK",handleSubmit:this.props.okCallback}))}}]),t}(q),Ae=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={modal:null,errMsg:""},n.setError=function(e){n.setState({modal:"error",errMsg:e})},n.inviteToRoom=function(e){n.setState({modal:null});var t=n.props.alphanumericFilter(e);t?fetch("".concat(z,"/api/UserRooms"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({recipientUsername:t,roomId:n.props.alphanumericFilter(n.props.roomProperties.id)})}).catch(function(){n.setError("Could not invite user")}):n.setError("Could not invite user")},n.deleteRoom=function(){n.setState({modal:null}),fetch("".concat(z,"/api/rooms/").concat(n.props.alphanumericFilter(n.props.roomProperties.id)),{method:"DELETE",credentials:"include"}).then(function(){n.props.socket.emit("roomDeleted"),n.props.resetFile(),n.props.disposeAllFurnishings(!0),n.props.clearUndoStack(),n.props.clearRedoStack()}).catch(function(){n.setError("Error deleting room")})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,"new"===this.state.modal?o.a.createElement(_e,{okCallback:function(t,n){e.setState({modal:null}),e.props.newRoom(t,n)},cancelCallback:function(){return e.setState({modal:null})}}):null,"error"===this.state.modal?o.a.createElement(Le,{message:this.state.errMsg,callback:function(){return e.setState({modal:null})}}):null,"open"===this.state.modal?o.a.createElement(Ne,{alphanumericFilter:this.props.alphanumericFilter,availableRooms:this.props.availableRooms||{},okCallback:function(t){e.setState({modal:null}),e.props.openRoom(t)},cancelCallback:function(){return e.setState({modal:null})}}):null,"invite"===this.state.modal?o.a.createElement(xe,{okCallback:this.inviteToRoom,cancelCallback:function(){return e.setState({modal:null})}}):null,"delete"===this.state.modal?o.a.createElement(Ue,{message:"Permanently delete this room?",cancelCallback:function(){return e.setState({modal:null})},okCallback:function(){return e.deleteRoom()}}):null,o.a.createElement("span",null,o.a.createElement(A,{value:"New",icon:o.a.createElement(ee.a,null),handleSubmit:function(){return e.setState({modal:"new"})}}),this.props.availableRooms?o.a.createElement(A,{value:"Open",icon:o.a.createElement(ne.a,null),handleSubmit:function(){return e.setState({modal:"open"})}}):null,this.props.roomProperties&&this.props.amOwner?o.a.createElement(A,{value:"Invite",icon:o.a.createElement(oe.a,null),handleSubmit:function(){return e.setState({modal:"invite"})}}):null,this.props.roomProperties&&this.props.amOwner?o.a.createElement(A,{value:"Delete Room",icon:o.a.createElement($.a,null),handleSubmit:function(){return e.setState({modal:"delete"})}}):null))}}]),t}(o.a.Component),ze=Object(c.b)(function(e){return{amOwner:e.file.amOwner,roomProperties:e.file.roomProperties,availableRooms:e.file.availableRooms}},function(e){return{addFurnishingFromObject:function(t,n,r,o,a){return e({type:"ADD_FURNISHING_FROM_OBJECT",obj:t,colors:n,renderer:r,camera:o,scene:a})},setIsOwner:function(t){return e({type:"SET_IS_OWNER",val:t})},setRoomProperties:function(t){return e({type:"SET_ROOM_PROPERTIES",roomProperties:t})},removeAllFurnishings:function(){return e({type:"REMOVE_ALL_FURNISHINGS"})},resetFile:function(){return e({type:"RESET_FILE"})}}})(Ae);var Ve=800,Ge=600;function Ke(e,t){return e>0?Math.atan(t/e):e<0&&t>0?Math.PI-Math.atan(Math.abs(t/e)):e<0&&t<0?-Math.PI+Math.atan(t/e):void 0}var Xe=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(u.a)(this,Object(p.a)(t).call(this))).state={cameraDispX:0,cameraDispZ:0,cameraRotDispY:0,rotatingCameraMode:!1,overheadView:!1,roomId:null},e.tossGarbage=function(){for(;this.garbage.length>0;){var e=this.garbage.pop();e.dispose&&e.dispose()}}.bind(Object(Ce.a)(e)),e.openRoom=function(e){var t=this,n=parseInt(e);-1!==n&&fetch("".concat(z,"/api/rooms/").concat(this.props.alphanumericFilter(n)),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){t.props.setRoomProperties(e),t.rebuildRoom(),fetch("".concat(z,"/api/rooms/").concat(t.props.alphanumericFilter(n),"/furnishings"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.error?(t.props.setErrMsg("Could not open room"),t.disposeAllFurnishings(!0),t.props.resetEverything()):(t.props.clearUndoStack(),t.props.clearRedoStack(),t.props.removeAllFurnishings(),Object.keys(e).forEach(function(n){t.props.addFurnishingFromObject(e[n],t.props.colors,t.renderer,t.camera,t.scene)}),t.props.socket.emit("join",{roomId:n}),fetch("".concat(z,"/api/rooms/").concat(t.props.alphanumericFilter(n),"/isOwner"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.status?t.props.setIsOwner(!0):t.props.setIsOwner(!1)}).catch(function(){}),t.props.setErrMsg(""),t.setState({roomId:n}))}).catch(function(){t.props.setErrMsg("Could not open room"),t.disposeAllFurnishings(!0),t.props.resetEverything()})}).catch(function(){t.props.setErrMsg("Could not open room"),t.disposeAllFurnishings(!0),t.props.resetEverything()})}.bind(Object(Ce.a)(e)),e.newRoom=function(e,t){var n=this,r=this.props.alphanumericReplace(e),o=this.props.alphanumericReplace(t);r&&o&&o.match(/^\d+$/)&&parseInt(o)>0&&parseInt(o)<11?fetch("".concat(z,"/api/rooms"),{method:"POST",headers:{"Content-type":"application/json"},credentials:"include",body:JSON.stringify({room:{name:r,length:parseInt(o)+3,width:parseInt(o)+3,height:4}})}).then(function(e){return e.json()}).then(function(e){e.error?n.props.setErrMsg("Could not create room (try a different name)"):(n.props.clearUndoStack(),n.props.clearRedoStack(),n.props.setIsOwner(!0),n.props.setRoomProperties(e),n.rebuildRoom(),n.props.socket.emit("join",{roomId:e.id}),n.setState({roomId:e.id}))}).catch(function(){return n.props.setErrMsg("Could not create room")}):this.props.setErrMsg("Could not create room")}.bind(Object(Ce.a)(e)),e.resetCamera=function(){var e=this;this.setState({cameraDispX:0,cameraDispZ:0,cameraRotDispY:0,rotatingCameraMode:!1,overheadView:!1},function(){e.camera.position.x=0+e.state.cameraDispX,e.camera.position.y=.5*e.props.roomProperties.height,e.camera.position.z=.9*e.props.roomProperties.width/2+e.state.cameraDispZ,e.camera.rotation.x=0,e.camera.rotation.y=0+e.state.cameraRotDispY,e.camera.rotation.z=0,e.renderer.render(e.scene,e.camera)})}.bind(Object(Ce.a)(e)),e.handleMove=function(e,t,n,r){var o=this;if(this.props.roomProperties&&this.props.lock.lockObtained&&this.props.lock.furnishingId&&this.props.lock.mouseDown){if("move"===this.props.mode.mode)if(this.state.overheadView){var a=this.props.roomProperties.width*n/Ve,s=this.props.roomProperties.length*r/Ge;this.moveX(a,this.props.lock.furnishingId),this.moveZ(s,this.props.lock.furnishingId),this.props.socket.emit("mouseMoved",{furnishingId:this.props.lock.furnishingId,diffX:a,diffZ:s,diffTheta:0})}else{var i=this.props.roomProperties.width*n/Ve,c=this.props.roomProperties.length*r/Ge,l=this.state.cameraRotDispY,h=i*Math.cos(l)+c*Math.sin(l),u=-1*i*Math.sin(l)+c*Math.cos(l);this.moveX(h,this.props.lock.furnishingId),this.moveZ(u,this.props.lock.furnishingId),this.props.socket.emit("mouseMoved",{furnishingId:this.props.lock.furnishingId,diffX:h,diffZ:u,diffTheta:0})}else if("rotate"===this.props.mode.mode){var p=(e-this.renderer.domElement.offsetLeft)/Ve*2-1,m=-(t-this.renderer.domElement.offsetTop)/Ge*2+1,d=p-this.props.lock.mousex,f=m-this.props.lock.mousey,g=n/Ve,b=r/Ge;if(0!==d&&0!==f&&0!==g&&0!==b){var v=Ke(d,f),w=Ke(d+g,f-b);if(Math.abs(v-w)<Math.PI){var E=3*(w-v);this.moveTheta(E,this.props.lock.furnishingId),this.props.socket.emit("mouseMoved",{furnishingId:this.props.lock.furnishingId,diffX:0,diffZ:0,diffTheta:E})}}}}else if(this.props.roomProperties&&this.props.lock.mouseDown)if(this.state.rotatingCameraMode||this.state.overheadView)this.state.overheadView||this.setState({cameraRotDispY:this.state.cameraRotDispY+5*n/Ve},function(){o.camera.position.x=0+o.state.cameraDispX,o.camera.position.y=.5*o.props.roomProperties.height,o.camera.position.z=.9*o.props.roomProperties.width/2+o.state.cameraDispZ,o.camera.rotation.x=0,o.camera.rotation.y=0+o.state.cameraRotDispY,o.camera.rotation.z=0,o.renderer.render(o.scene,o.camera)});else{var O=-this.props.roomProperties.width*n/Ve,y=-this.props.roomProperties.length*r/Ge,k=this.state.cameraRotDispY;this.setState({cameraDispX:this.state.cameraDispX+O*Math.cos(k)+y*Math.sin(k),cameraDispZ:this.state.cameraDispZ-O*Math.sin(k)+y*Math.cos(k)},function(){o.camera.position.x=0+o.state.cameraDispX,o.camera.position.y=.5*o.props.roomProperties.height,o.camera.position.z=.9*o.props.roomProperties.width/2+o.state.cameraDispZ,o.camera.rotation.x=0,o.camera.rotation.y=0+o.state.cameraRotDispY,o.camera.rotation.z=0,o.renderer.render(o.scene,o.camera)})}}.bind(Object(Ce.a)(e)),e.handleDown=function(e,t){var n=this,r=new f.q;r.x=(e-this.renderer.domElement.offsetLeft)/Ve*2-1,r.y=-(t-this.renderer.domElement.offsetTop)/Ge*2+1,this.props.setMouseDown(r.x,r.y),this.raycaster.setFromCamera(r,this.camera);var o=null,a=-1;this.props.room.forEach(function(e){var t=e.checkIntersect(n.raycaster);t>-.99&&(a<-.99||t<a)&&(a=t,o=e)}),o&&("move"===this.props.mode.mode||"rotate"===this.props.mode.mode?(this.pushRoomToUndoStack(),this.props.socket.emit("pushRoomToUndoStack"),this.props.socket.emit("clearRedoStack"),this.props.socket.emit("lockRequest",{furnishingId:o.id}),this.props.setLockRequested(),this.props.setFurnishing(o.id),"dummy"===this.props.username&&this.props.setLockApproved()):"color"===this.props.mode.mode?(this.props.socket.emit("updateColor",{furnishingId:o.id,colorName:this.props.mode.colorName}),this.props.setMode("move")):"delete"===this.props.mode.mode&&(this.props.socket.emit("deleteFurnishing",{furnishingId:o.id}),this.props.setMode("move")))}.bind(Object(Ce.a)(e)),e.handleUp=function(){var e=this;this.props.lock.lockObtained&&this.props.lock.furnishingId&&(this.props.clearRedoStack(),this.props.socket.emit("lockRelease",{furnishing:this.props.room.find(function(t){return t.id===e.props.lock.furnishingId})}),this.props.unLock()),this.props.unSetMouseDown(),this.tossGarbage()}.bind(Object(Ce.a)(e)),e.buildSocketEvents=function(){var e=this;this.props.socket.on("disconnect",function(){e.props.setErrMsg("There is a problem with the connection."),e.disposeAllFurnishings(!0),e.props.resetEverything()}),this.props.socket.on("reconnect",function(){e.props.setErrMsg(""),e.props.socket.emit("loggedInReconnectEvent")}),this.props.socket.on("loggedInReconnectEventResponse",function(t){"logged in"===t?e.state.roomId&&e.openRoom(e.state.roomId):(e.disposeAllFurnishings(!0),e.props.resetEverything(),e.props.modeLogout(),e.props.lockLogout(),e.props.fileLogout(),e.props.roomLogout(),fetch("".concat(z,"/api/login"),{method:"DELETE",credentials:"include"}).then(function(){return e.props.history.push("/")}))}),this.props.socket.on("roomDeleted",function(){e.props.setErrMsg("The room was deleted."),e.props.socket.emit("removeFromAllRooms"),e.disposeAllFurnishings(!0),e.props.resetEverything()}),this.props.socket.on("create",function(t){e.pushRoomToUndoStack(),e.props.clearRedoStack(),e.props.addFurnishingFromObject(t.furnishing,e.props.colors,e.renderer,e.camera,e.scene)}),this.props.socket.on("lockResponse",function(t){"approved"===t?e.props.setLockApproved():e.props.unLock()}),this.props.socket.on("pushRoomToRedoStack",function(t){e.pushRoomToRedoStack()}),this.props.socket.on("pushRoomToUndoStack",function(t){e.pushRoomToUndoStack()}),this.props.socket.on("clearRedoStack",function(t){e.props.clearRedoStack()}),this.props.socket.on("clearUndoStack",function(t){e.props.clearUndoStack()}),this.props.socket.on("undo",function(t){e.handleUndo(t.room)}),this.props.socket.on("redo",function(t){e.handleRedo(t.room)}),this.props.socket.on("update",function(t){var n=e.props.room.find(function(e){return e.id===t.furnishing.id});n&&(n.updateFromObject(t.furnishing,e.props.colors),e.renderer.render(e.scene,e.camera))}),this.props.socket.on("delete",function(t){var n=e.props.room.find(function(e){return e.id===t.furnishingId});n&&(e.pushRoomToUndoStack(),e.props.clearRedoStack(),n.removeFrom(e.scene),e.props.deleteFurnishing(t.furnishingId),e.renderer.render(e.scene,e.camera))}),this.props.socket.on("colorUpdate",function(t){var n=e.props.room.find(function(e){return e.id===t.furnishingId});n&&(e.pushRoomToUndoStack(),e.props.clearRedoStack(),n.colorName=t.colorName,n.red=e.props.colors[t.colorName].red,n.green=e.props.colors[t.colorName].green,n.blue=e.props.colors[t.colorName].blue,n.fillColor(),e.renderer.render(e.scene,e.camera))}),this.props.socket.on("availableRooms",function(t){e.props.setAvailableRooms(t.availableRooms)}),this.props.socket.on("mouseMoved",function(t){var n=e.props.room.find(function(e){return e.id===t.furnishingId});n&&(n.moveX(t.diffX),n.moveZ(t.diffZ),n.moveTheta(t.diffTheta),e.renderer.render(e.scene,e.camera))})}.bind(Object(Ce.a)(e)),e.rebuildRoom=function(){this.renderer&&this.light&&this.camera&&(this.removeTransients(),this.tossGarbage(),this.disposeAllFurnishings(),this.scene=b.doInit(this.renderer,this.light,this.camera),this.state.overheadView?(this.camera.position.x=0,this.camera.position.y=.95*this.props.roomProperties.width,this.camera.position.z=0,this.camera.rotation.x=-Math.PI/2,this.camera.rotation.y=0,this.camera.rotation.z=0):(this.camera.position.x=0+this.state.cameraDispX,this.camera.position.y=.5*this.props.roomProperties.height,this.camera.position.z=.9*this.props.roomProperties.width/2+this.state.cameraDispZ,this.camera.rotation.x=0,this.camera.rotation.y=0+this.state.cameraRotDispY,this.camera.rotation.z=0),this.light.castShadow=!0,this.light.shadow.bias=-2e-4,this.light.position.set(0,.9*this.props.roomProperties.height,0*this.props.roomProperties.length/2),this.floor=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.length),new f.h({color:"white",side:f.e})),this.floor.receiveShadow=!0,this.floor.castShadow=!0,this.floor.rotation.x=Math.PI/2,this.floor.position.y=.15,this.ceiling=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.length),new f.h({color:"white"})),this.ceiling.receiveShadow=!0,this.ceiling.castShadow=!0,this.ceiling.rotation.x=Math.PI/2,this.ceiling.position.set(0,this.props.roomProperties.height,0),this.wallLeft=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.height),new f.h({color:"white"})),this.wallLeft.receiveShadow=!0,this.wallLeft.castShadow=!0,this.wallLeft.rotation.y=1*Math.PI/2,this.wallLeft.position.set(-this.props.roomProperties.width/2,this.props.roomProperties.height/2,0),this.wallRight=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.height),new f.h({color:"white"})),this.wallRight.receiveShadow=!0,this.wallRight.castShadow=!0,this.wallRight.rotation.y=-1*Math.PI/2,this.wallRight.position.set(this.props.roomProperties.width/2,this.props.roomProperties.height/2,0),this.wallBack=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.height),new f.h({color:"white"})),this.wallBack.receiveShadow=!0,this.wallBack.castShadow=!0,this.wallBack.position.set(0,this.props.roomProperties.height/2,-this.props.roomProperties.length/2),this.wallFront=new f.g(new f.l(this.props.roomProperties.width,this.props.roomProperties.height),new f.h({color:"white"})),this.wallFront.rotation.y=Math.PI,this.wallFront.receiveShadow=!0,this.wallFront.castShadow=!0,this.wallFront.position.set(0,this.props.roomProperties.height/2,this.props.roomProperties.length/2),this.scene.add(this.floor),this.scene.add(this.wallLeft),this.scene.add(this.wallRight),this.scene.add(this.wallBack),this.scene.add(this.ceiling),this.scene.add(this.wallFront),this.scene.add(this.ambientLight),this.renderer.render(this.scene,this.camera))}.bind(Object(Ce.a)(e)),e.removeTransients=function(){this.scene&&this.scene.dispose(),this.floor&&(this.garbage.push(this.floor.geometry),this.garbage.push(this.floor.material),delete this.floor),this.ceiling&&(this.garbage.push(this.ceiling.geometry),this.garbage.push(this.ceiling.material),delete this.ceiling),this.wallLeft&&(this.garbage.push(this.wallLeft.geometry),this.garbage.push(this.wallLeft.material),delete this.wallLeft),this.wallRight&&(this.garbage.push(this.wallRight.geometry),this.garbage.push(this.wallRight.material),delete this.wallRight),this.wallBack&&(this.garbage.push(this.wallBack.geometry),this.garbage.push(this.wallBack.material),delete this.wallBack),this.wallFront&&(this.garbage.push(this.wallFront.geometry),this.garbage.push(this.wallFront.material),delete this.wallFront)}.bind(Object(Ce.a)(e)),e.moveX=function(e,t){this.props.room.find(function(e){return e.id===t}).moveX(e),this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.moveZ=function(e,t){this.props.room.find(function(e){return e.id===t}).moveZ(e),this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.moveTheta=function(e,t){this.props.room.find(function(e){return e.id===t}).moveTheta(e),this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.handleMouseMove=function(e){e.preventDefault(),this.handleMove(e.pageX,e.pageY,e.movementX,e.movementY)}.bind(Object(Ce.a)(e)),e.handleTouchMove=function(e){var t=this.lastTouchMoveX,n=this.lastTouchMoveY;this.lastTouchMoveX=e.touches[0].pageX,this.lastTouchMoveY=e.touches[0].pageY,t&&n&&this.handleMove(e.touches[0].pageX,e.touches[0].pageY,e.touches[0].pageX-t,e.touches[0].pageY-n)}.bind(Object(Ce.a)(e)),e.handleMouseDown=function(e){e.preventDefault(),this.handleDown(e.pageX,e.pageY)}.bind(Object(Ce.a)(e)),e.handleTouchStart=function(e){this.handleDown(e.touches[0].pageX,e.touches[0].pageY)}.bind(Object(Ce.a)(e)),e.handleMouseUp=function(e){e.preventDefault(),this.handleUp()}.bind(Object(Ce.a)(e)),e.handleTouchEnd=function(e){this.lastTouchMoveX=null,this.lastTouchMoveY=null,this.handleUp()}.bind(Object(Ce.a)(e)),e.disposeAllFurnishings=function(e){if(this.props.room){for(var t=0;t<this.props.room.length;t++)this.props.room[t].removeFrom(this.scene);this.props.removeAllFurnishings(),e&&(this.scene.dispose(),this.scene=new f.o,this.scene.background=new f.c(16777215),this.renderer.render(this.scene,this.camera))}}.bind(Object(Ce.a)(e)),e.handleMoveCamera=function(){this.setState({rotatingCameraMode:!1,overheadView:!1}),this.camera.position.x=0+this.state.cameraDispX,this.camera.position.y=.5*this.props.roomProperties.height,this.camera.position.z=.9*this.props.roomProperties.width/2+this.state.cameraDispZ,this.camera.rotation.x=0,this.camera.rotation.y=0+this.state.cameraRotDispY,this.camera.rotation.z=0,this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.handleRotateCamera=function(){this.setState({rotatingCameraMode:!0,overheadView:!1}),this.camera.position.x=0+this.state.cameraDispX,this.camera.position.y=.5*this.props.roomProperties.height,this.camera.position.z=.9*this.props.roomProperties.width/2+this.state.cameraDispZ,this.camera.rotation.x=0,this.camera.rotation.y=0+this.state.cameraRotDispY,this.camera.rotation.z=0,this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.handleOverhead=function(){this.setState({rotatingCameraMode:!1,overheadView:!0}),this.camera.position.x=0,this.camera.position.y=.95*this.props.roomProperties.width,this.camera.position.z=0,this.camera.rotation.x=-Math.PI/2,this.camera.rotation.y=0,this.camera.rotation.z=0,this.renderer.render(this.scene,this.camera)}.bind(Object(Ce.a)(e)),e.pushRoomToUndoStack=function(){var e=this.props.room.map(function(e){return e.objVal()});this.props.pushToUndoStack(e)}.bind(Object(Ce.a)(e)),e.pushRoomToRedoStack=function(){var e=this.props.room.map(function(e){return e.objVal()});this.props.pushToRedoStack(e)}.bind(Object(Ce.a)(e)),e.handleUndo=function(e){this.props.roomProperties&&(this.pushRoomToRedoStack(),this.loadRoomFromState(e),this.props.popUndoStack())}.bind(Object(Ce.a)(e)),e.handleRedo=function(e){this.props.roomProperties&&(this.pushRoomToUndoStack(),this.loadRoomFromState(e),this.props.popRedoStack())}.bind(Object(Ce.a)(e)),e.loadRoomFromState=function(e){var t=this;this.disposeAllFurnishings(!0),this.rebuildRoom(),e.forEach(function(e){t.props.addFurnishingFromObject(e,t.props.colors,t.renderer,t.camera,t.scene)})}.bind(Object(Ce.a)(e)),e.garbage=[],e}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.buildSocketEvents();var t=document.querySelector("#mc");this.canvas=t,this.renderer=new f.r({canvas:t,physicallyCorrectLights:!0}),this.raycaster=new f.n,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=f.j,this.camera=new f.k(75,Ve/Ge,.1,100),this.light=new f.m(16777215,1,100),this.light.decay=2,this.ambientLight=new f.a(4210752),this.scene=new f.o,this.scene.background=new f.c(16777215),this.renderer.render(this.scene,this.camera),this.interval=setInterval(function(){e.props.lock.lockObtained&&e.props.socket.emit("lockRefresh",{furnishingId:e.props.lock.furnishingId})},1e3),"dummy"===this.props.username&&fetch("".concat(z,"/api/users/dummy/rooms"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){Object.keys(t).forEach(function(n){"dummy"===t[n].name&&e.openRoom(t[n].id)})})}},{key:"componentWillUnmount",value:function(){this.disposeAllFurnishings(),this.removeTransients(),this.tossGarbage(),this.props.resetEverything(),this.props.clearUndoStack(),this.props.clearRedoStack(),clearInterval(this.interval),this.interval=null}},{key:"render",value:function(){var e=this;return this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera),o.a.createElement(o.a.Fragment,null,o.a.createElement(ze,{clearUndoStack:this.props.clearUndoStack,clearRedoStack:this.props.clearRedoStack,newRoom:this.newRoom,openRoom:this.openRoom,disposeAllFurnishings:this.disposeAllFurnishings,renderer:function(){return e.renderer},camera:function(){return e.camera},scene:function(){return e.scene},alphanumericFilter:this.props.alphanumericFilter,username:this.props.username,colors:this.props.colors,socket:this.props.socket}),o.a.createElement(A,{value:"Undo",icon:o.a.createElement(Me.a,null),handleSubmit:function(){e.props.undo.length>0&&e.props.socket.emit("undo",{room:e.props.undo[e.props.undo.length-1]})}}),o.a.createElement(A,{value:"Redo",icon:o.a.createElement(De.a,null),handleSubmit:function(){e.props.redo.length>0&&e.props.socket.emit("redo",{room:e.props.redo[e.props.redo.length-1]})}}),o.a.createElement(A,{value:"Help",icon:o.a.createElement(se.a,null),handleSubmit:this.props.openHelp}),o.a.createElement("div",null,this.props.roomProperties?o.a.createElement(Pe,{pushRoomToUndoStack:this.pushRoomToUndoStack,renderer:function(){return e.renderer},camera:function(){return e.camera},scene:function(){return e.scene},alphanumericFilter:this.props.alphanumericFilter,socket:this.props.socket,colors:this.props.colors,username:this.props.username}):null,this.props.roomProperties?o.a.createElement(A,{icon:o.a.createElement(ye.a,null),value:"Reset Camera",handleSubmit:this.resetCamera}):null,this.props.roomProperties?o.a.createElement(A,{style:{backgroundColor:this.state.rotatingCameraMode||this.state.overheadView?"white":"yellow"},icon:o.a.createElement(Se.a,null),value:"Move Camera",handleSubmit:this.handleMoveCamera}):null,this.props.roomProperties?o.a.createElement(A,{style:{backgroundColor:this.state.rotatingCameraMode&&!this.state.overheadView?"yellow":"white"},icon:o.a.createElement(ve.a,null),value:"Rotate Camera",handleSubmit:this.handleRotateCamera}):null,this.props.roomProperties?o.a.createElement(A,{style:{backgroundColor:this.state.overheadView?"yellow":"white"},value:"Overhead View",icon:o.a.createElement(Ee.a,null),handleSubmit:this.handleOverhead}):null),o.a.createElement("div",{width:Ve,height:Ge,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onMouseMove:this.handleMouseMove,onTouchMove:this.handleTouchMove,onMouseUp:this.handleMouseUp,onTouchEnd:this.handleTouchEnd,onTouchCancel:this.handleTouchEnd,onMouseOut:this.handleMouseUp},o.a.createElement("canvas",{id:"mc",width:Ve,height:Ge},"Your browser doesn't appear to support HTML5 Canvas.")))}}]),t}(o.a.Component),He=Object(c.b)(function(e){return{room:e.room,lock:e.lock,mode:e.mode,roomProperties:e.file.roomProperties,undo:e.undo,redo:e.redo}},function(e){return{setFurnishing:function(t){return e({type:"SET_FURNISHING",furnishingId:t})},unLock:function(){return e({type:"UN_LOCK"})},setLockApproved:function(){return e({type:"SET_LOCK_APPROVED"})},brighten:function(t,n){return e({type:"BRIGHTEN",furnishingId:t,colors:n})},setLockRequested:function(){return e({type:"SET_LOCK_REQUESTED"})},roomDoNothing:function(){return e({type:"ROOM_DO_NOTHING"})},moveX:function(t,n,r){return e({type:"MOVE_X",dx:t,furnishingId:n,colors:r})},moveZ:function(t,n,r){return e({type:"MOVE_Z",dz:t,furnishingId:n,colors:r})},moveTheta:function(t,n,r){return e({type:"MOVE_THETA",dtheta:t,furnishingId:n,colors:r})},setMouseDown:function(t,n){return e({type:"SET_MOUSE_DOWN",mousex:t,mousey:n})},unSetMouseDown:function(){return e({type:"UN_SET_MOUSE_DOWN"})},dim:function(t,n){return e({type:"DIM",furnishingId:t,colors:n})},setMode:function(t){return e({type:"SET_MODE",mode:t})},resetEverything:function(){e({type:"REMOVE_ALL_FURNISHINGS"}),e({type:"RESET_FILE"}),e({type:"LOCK_LOGOUT"}),e({type:"MODE_LOGOUT"})},removeAllFurnishings:function(){e({type:"REMOVE_ALL_FURNISHINGS"})},addFurnishingFromObject:function(t,n,r,o,a){return e({type:"ADD_FURNISHING_FROM_OBJECT",obj:t,colors:n,renderer:r,camera:o,scene:a})},deleteFurnishing:function(t){return e({type:"DELETE_FURNISHING",furnishingId:t})},updateColor:function(t,n,r){return e({type:"UPDATE_COLOR",furnishingId:t,colorName:n,colors:r})},setAvailableRooms:function(t){return e({type:"SET_AVAILABLE_ROOMS",rooms:t})},setRoomProperties:function(t){return e({type:"SET_ROOM_PROPERTIES",roomProperties:t})},setIsOwner:function(t){return e({type:"SET_IS_OWNER",val:t})},modeLogout:function(){return e({type:"MODE_LOGOUT"})},lockLogout:function(){return e({type:"LOCK_LOGOUT"})},fileLogout:function(){return e({type:"FILE_LOGOUT"})},roomLogout:function(){return e({type:"ROOM_LOGOUT"})},clearUndoStack:function(){return e({type:"CLEAR_UNDO_STACK"})},clearRedoStack:function(){return e({type:"CLEAR_REDO_STACK"})},pushToUndoStack:function(t){return e({type:"PUSH_TO_UNDO_STACK",stateToPush:t})},popUndoStack:function(){return e({type:"POP_UNDO_STACK"})},pushToRedoStack:function(t){return e({type:"PUSH_TO_REDO_STACK",stateToPush:t})},popRedoStack:function(){return e({type:"POP_REDO_STACK"})}}})(Xe),qe=n(952),Ye=window.location.href.includes("localhost")?"ws://localhost:8000":"wss://spaceplanner3d.herokuapp.com",Ze=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",socket:null,colors:{},errMsg:null,modal:null},n.setErrMsg=function(e){n.setState({errMsg:e})},n.handleLogout=function(e){e.preventDefault(),n.props.modeLogout(),n.props.lockLogout(),n.props.fileLogout(),n.props.roomLogout(),fetch("".concat(z,"/api/login"),{method:"DELETE",credentials:"include"}).then(function(){return n.props.history.push("/")})},n.openHelp=function(){n.setState({modal:"help"})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(z,"/api/colors"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){t.forEach(function(t){var n=Object(_.a)({},e.state.colors);n[t.name]={red:t.red,green:t.green,blue:t.blue},e.setState({colors:n})}),fetch("".concat(z,"/api/loggedin"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){if(t.status&&t.status.includes("Logged in as ")){var n=e.props.alphanumericFilter(t.status.split(" ")[3]);e.setState({username:n},function(){return e.setState({socket:qe(Ye,{transports:["websocket"]})})}),fetch("".concat(z,"/api/users/").concat(e.props.alphanumericFilter(n),"/rooms"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){e.props.setAvailableRooms(t)}).catch(function(){}),e.roomsInterval=setInterval(function(){e.state.socket&&e.state.socket.emit("getAvailableRooms")},5e3)}else e.props.history.push("/")})}).catch(function(){})}},{key:"componentWillUnmount",value:function(){this.roomsInterval&&(clearInterval(this.roomsInterval),this.roomsInterval=null),this.state.socket&&this.state.socket.emit&&this.state.socket.emit("removeFromAllRooms")}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,"help"===this.state.modal?o.a.createElement(Te,{okCallback:function(){return e.setState({modal:null})}}):null,o.a.createElement("div",null,o.a.createElement("div",{style:{width:"100%",paddingLeft:"50px"}},o.a.createElement("p",null," ",o.a.createElement("b",null,"dummy"!==this.state.username?this.state.username:null)," ",this.state.errMsg?o.a.createElement("span",{style:{color:"red"}},o.a.createElement("b",null,this.state.errMsg)):null),o.a.createElement("form",{style:{display:"inline"},onSubmit:this.handleLogout},o.a.createElement("button",{type:"submit",title:"Logout"},o.a.createElement(U.a,null,o.a.createElement(J.a,null)))),o.a.createElement("form",{style:{display:"inline"},onSubmit:function(){return e.props.history.push("/manageAccount")}},o.a.createElement("button",{type:"submit",title:"Manage Account"},o.a.createElement(U.a,null,o.a.createElement(Z.a,null)))),this.state.socket?o.a.createElement(He,{history:this.props.history,openHelp:this.openHelp,setErrMsg:this.setErrMsg,alphanumericReplace:this.props.alphanumericReplace,alphanumericFilter:this.props.alphanumericFilter,username:this.state.username,colors:this.state.colors,socket:this.state.socket}):null)))}}]),t}(o.a.Component),Be=Object(c.b)(function(e){return{roomProperties:e.file.roomProperties,lock:e.lock}},function(e){return{addFurnishingFromObject:function(t,n){return e({type:"ADD_FURNISHING_FROM_OBJECT",obj:t,colors:n})},setAvailableRooms:function(t){return e({type:"SET_AVAILABLE_ROOMS",rooms:t})},unLock:function(){return e({type:"UN_LOCK"})},setLockApproved:function(){return e({type:"SET_LOCK_APPROVED"})},brighten:function(t,n){return e({type:"BRIGHTEN",furnishingId:t,colors:n})},deleteFurnishing:function(t){return e({type:"DELETE_FURNISHING",furnishingId:t})},updateColor:function(t,n,r){return e({type:"UPDATE_COLOR",furnishingId:t,colorName:n,colors:r})},modeLogout:function(){return e({type:"MODE_LOGOUT"})},lockLogout:function(){return e({type:"LOCK_LOGOUT"})},fileLogout:function(){return e({type:"FILE_LOGOUT"})},roomLogout:function(){return e({type:"ROOM_LOGOUT"})},resetEverything:function(){e({type:"REMOVE_ALL_FURNISHINGS"}),e({type:"RESET_FILE"}),e({type:"LOCK_LOGOUT"}),e({type:"MODE_LOGOUT"})}}})(Ze),Je=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={err:"",modal:null},n.handleSubmit=function(e){e.preventDefault();var t=n.props.alphanumericFilter(document.querySelector("#username").value),r=n.props.alphanumericFilter(document.querySelector("#password").value);t&&r?fetch("".concat(z,"/api/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:r}),credentials:"include"}).then(function(e){return e.json()}).then(function(e){e.success?n.props.history.push("/main"):n.setState({err:"Could not log in"})}):n.setState({err:"Username and password must be alphanumeric."})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(z,"/api/loggedin"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){t.status.includes("Logged in as ")&&e.props.history.push("/main")})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{width:"80%",paddingLeft:"50px",paddingTop:"20px"}},o.a.createElement(A,{value:"Sign Up",handleSubmit:function(){return e.props.history.push("/signup")}}),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("p",null,"Username: ",o.a.createElement("input",{type:"text",id:"username",name:"username",defaultValue:"dummy"})),o.a.createElement("p",null,"Password: ",o.a.createElement("input",{type:"password",id:"password",name:"password",defaultValue:"abcdef"})),o.a.createElement("p",{style:{color:"red"}},o.a.createElement("b",null,this.state.err)),o.a.createElement("p",null,o.a.createElement("button",{type:"submit"},"Login"))),o.a.createElement("p",null,o.a.createElement("b",null,"Dummy account:"),' username "dummy", password "abcdef" (without the quotes).'))}}]),t}(o.a.Component),We=function(e){function t(){return Object(h.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:{zIndex:2,top:"0px",paddingLeft:"50px",paddingTop:"25px",margin:"0px",width:"100%",height:"80px",backgroundColor:"#edcc53",fontFamily:"sans-serif",fontSize:"25pt",fontWeight:"bold"}},"Space Planner 3D")}}]),t}(o.a.Component),$e=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={err:"",modal:null,deleteUsername:""},n.handleSubmit=function(e){e.preventDefault();var t=n.props.alphanumericFilter(document.querySelector("#username").value),r=n.props.alphanumericFilter(document.querySelector("#oldPassword").value),o=n.props.alphanumericFilter(document.querySelector("#password").value),a=n.props.alphanumericFilter(document.querySelector("#confirmPassword").value);t&&r&&o&&a?o!==a?n.setState({err:"New passwords must match"}):fetch("".concat(z,"/api/users/").concat(t,"/password"),{method:"PATCH",headers:{"Content-type":"application/json"},credentials:"include",body:JSON.stringify({currentPassword:r,newPassword:o})}).then(function(e){return e.json()}).then(function(e){e.success?n.props.history.push("/main"):n.setState({err:"Could not create user"})}):n.setState({err:"Username and password must be alphanumeric."})},n.deleteAccount=function(){var e=n.props.alphanumericFilter(n.state.deleteUsername);e&&fetch("".concat(z,"/api/users/").concat(e),{method:"DELETE",credentials:"include"}).then(function(){return fetch("".concat(z,"/api/login"),{method:"DELETE",credentials:"include"}).then(function(){n.props.history.push("/")})})},n.handleDelete=function(e){var t=document.querySelector("#deleteUsername").value;e.preventDefault(),e.target.reset(),n.setState({modal:"delete",deleteUsername:t})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(z,"/api/loggedin"),{method:"GET",credentials:"include"}).then(function(e){return e.json()}).then(function(t){t.status.includes("Logged in as ")||e.props.history.push("/")})}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,"delete"===this.state.modal?o.a.createElement(Ue,{message:"Permanently delete this account?",cancelCallback:function(){return e.setState({modal:null})},okCallback:function(){e.setState({modal:null}),e.deleteAccount()}}):null,o.a.createElement("div",{style:{width:"100%",paddingLeft:"50px",paddingTop:"20px"}},o.a.createElement(A,{value:"Return to Main",handleSubmit:function(){return e.props.history.push("/main")}}),o.a.createElement("h2",null,"Change Password"),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("p",null,"Username: ",o.a.createElement("input",{type:"text",id:"username"})),o.a.createElement("p",null,"Old Password: ",o.a.createElement("input",{type:"password",id:"oldPassword"})),o.a.createElement("p",null,"New Password: ",o.a.createElement("input",{type:"password",id:"password"})),o.a.createElement("p",null,"Confirm New Password: ",o.a.createElement("input",{type:"password",id:"confirmPassword"})),o.a.createElement("p",{style:{color:"red"}},o.a.createElement("b",null,this.state.err)),o.a.createElement("p",null,o.a.createElement("button",{type:"submit"},"Submit"))),o.a.createElement("h2",null,"Delete Account"),o.a.createElement("form",{onSubmit:this.handleDelete},o.a.createElement("p",null,"Enter Username: ",o.a.createElement("input",{type:"text",id:"deleteUsername"})),o.a.createElement("p",null,o.a.createElement("button",{type:"submit"},"Delete Account")))))}}]),t}(o.a.Component),Qe=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).alphanumericFilter=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?/^[a-zA-Z0-9 ]*$/:/^[a-zA-Z0-9]*$/;return e&&e.toString&&e.toString().match(t)?e.toString():null},n.alphanumericReplace=function(e){return e&&e.toString?e.toString().replace(/[^a-zA-Z0-9]/g,""):null},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(N.a,null,o.a.createElement(We,null),o.a.createElement(x.a,{exact:!0,path:"/",render:function(t){return o.a.createElement(Je,Object.assign({},t,{alphanumericFilter:e.alphanumericFilter}))}}),o.a.createElement(x.a,{exact:!0,path:"/signup",render:function(t){return o.a.createElement(V,Object.assign({},t,{alphanumericFilter:e.alphanumericFilter}))}}),o.a.createElement(x.a,{exact:!0,path:"/main",render:function(t){return o.a.createElement(Be,Object.assign({},t,{alphanumericReplace:e.alphanumericReplace,alphanumericFilter:e.alphanumericFilter}))}}),o.a.createElement(x.a,{exact:!0,path:"/manageAccount",render:function(t){return o.a.createElement($e,Object.assign({},t,{alphanumericFilter:e.alphanumericFilter}))}}))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var et=Object(i.c)(L);s.a.render(o.a.createElement(c.a,{store:et},o.a.createElement(Qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[413,1,2]]]);
//# sourceMappingURL=main.3d0c8534.chunk.js.map